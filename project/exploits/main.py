from selenium import webdriver
import unittest


class SQLInjection(unittest.TestCase):
    def set_up(self):
        # create a headless Chrome browser
        op = webdriver.ChromeOptions()
        op.add_argument("headless")
        self.driver = webdriver.Chrome("~/chromedriver", options=op)

    def test_signup_name_injection(self):
        # load the page you want to test
        self.driver.get("http://localhost:5000")

        # get the signup form elements
        form = self.driver.find_element_by_id("signup-form")
        name_input = self.driver.find_element_by_id("signup-form-name")
        email_input = self.driver.find_element_by_id("signup-form-email")
        password_input = self.driver.find_element_by_id("signup-form-password")

        # enter text for SQL injection
        name_input.send_keys(" OR 1=1")
        email_input.send_keys("test@example.com")
        password_input.send_keys("password123")

        form.submit()

    def close(self):
        # close the browser window
        self.driver.quit()


class XSS(unittest.TestCase):
    def set_up(self):
        # create a headless Chrome browser
        op = webdriver.ChromeOptions()
        op.add_argument("headless")
        self.driver = webdriver.Chrome("~/chromedriver", options=op)

    def test_signup_name_injection(self):
        # load the page you want to test
        self.driver.get("http://localhost:5000")

        # get the signup form elements
        form = self.driver.find_element_by_id("signup-form")
        name_input = self.driver.find_element_by_id("signup-form-name")
        email_input = self.driver.find_element_by_id("signup-form-email")
        password_input = self.driver.find_element_by_id("signup-form-password")

        # enter text for SQL injection
        name_input.send_keys("<script> alert(1); </script>")
        email_input.send_keys("test@example.com")
        password_input.send_keys("password123")

        form.submit()

    def close(self):
        # close the browser window
        self.driver.quit()


if __name__ == "__main__":
    unittest.main(verbosity=2)
